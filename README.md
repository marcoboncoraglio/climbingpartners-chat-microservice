## AWS CLI commands

```
sam deploy --guided

aws cloudformation describe-stacks \
    --stack-name simple-websocket-chat-app --query 'Stacks[].Outputs'
```

## Testing the chat API
 
``` bash
$ wscat -c wss://e3v3oxocaj.execute-api.eu-central-1.amazonaws.com/staging
{"action":"sendmessage", "data":"hello world"}

{
    "action":"sendmessage", 
    "data": {
        "message": {
            chatId: Id
            author: Id
            text: String
        },
        "newChatRoom": {
            name: Id
            participants: [Id]
        }
    }
    
}

Creates a new chat room with 2 participants
{
    "action":"sendmessage", 
    "data": {
        "message": {
            author: 60f970e6d61e5a318f95b326
            text: "hello world"
        },
        "newChatRoom": {
            name: "test chat room"
            participants: ["60f882ff47e408d999e2ae1c", "60f970e6d61e5a318f95b326"]
        }
    }
}

// expiration date 3d
id1: 60f882ff47e408d999e2ae1c
token1: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYwZjg4MmZmNDdlNDA4ZDk5OWUyYWUxYyIsImlhdCI6MTYyNjk3MTkzNiwiZXhwIjoxNjI3MjMxMTM2fQ.ZFRrQFRWxUStz8NR_slrFzq3QhyCSI5hWKY7Zdm9BzY

id2: 60f970e6d61e5a318f95b326
token2: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYwZjk3MGU2ZDYxZTVhMzE4Zjk1YjMyNiIsImlhdCI6MTYyNjk3MTk5NCwiZXhwIjoxNjI3MjMxMTk0fQ.xfuwwRuxQzxKIYbX7BMDAdOHX05oicz3l5HTRX7xwdU


The body contains either message.chatId or newChatRoom object. This signals whether this is the first message of the conversation. If that is the case, open a new chat room and use autogenerated chatId to save message. Otherwise use the chatId in the message object.

message.chatId is optional.

newChatRoom is optional.
```

## TODO

Implement save chat



## Before deploy



Check regulations for saving chat

Add jwt authentication with the same secret as the climbingpartners-backend so we can verify the user
Add cors to check that requests are coming from the frontend
